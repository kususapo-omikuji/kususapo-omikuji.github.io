<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>くすサポおみくじ2024</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Hina+Mincho&display=swap&text=01234RU、ぁあぃいうえおかがきぎくぐけこさしじすせそただちっつてでとどなにねのはばぱひびふべまみめもゃやゆよらりるれわをんアイガキクケゲコサシスソチッテデトドナハプベペポムャラリロンー一上中井休内円凶凸出切前剥双口吉向地多大天始家小常年引当待忘恒悟意成戦払抜接推支方末本枚泣注炎無玉球理癖白盛盤目直真眼知石積終編聞育般良覚言詫認貯買近返連進運鏡間頭顔飲！" rel="stylesheet">

<style>

body {
    margin: 0;
    padding: 0;
    font-family: 'Hina Mincho', sans-serif;
}
body * {
    margin: 0;
    padding: 0;
}

/* おみくじを引く前 */
.wrapper {
    display: grid;
    place-items: center;
    overflow: hidden;
}
.title {
    margin: 40px 0;
    font-size: 30px;
    color: #d82234;
}
.omikuji {
    max-width: 250px;
}
button {
    margin: 40px 0;
    width: 280px;
    padding: 20px;
    border: none;
    border-radius: 50px;
    font-size: 25px;
    font-weight: bold;
    color: #fff;
    background: #d82234;
    cursor: pointer;
    font-family: 'Hina Mincho', sans-serif;
}
button:hover {
    background: rgba(216, 34, 52, 0.8)
}
button:active {
    transform: translateY(10px);
    transition: 0.6s;
}

/* おみくじを引いた後 */
.resultWrapper {
    display: none;
    place-items: center;
}
.resultWrapper h1 {
    color: #d82234;
    text-align: center;
    font-size: 20px;
}
.resultContainer {
    display: flex;
    flex-direction: column;
    width: calc(100% - 40px);
    max-width: 400px;
    margin: 20px 0 10px 0;
    color: #d82234;
    border: 4px double #d82234;
}
.resultRow {
    display: flex;
    flex-direction: row;
    flex-grow: 1;
    margin: 0 10px;
    padding: 10px 0;
    border-bottom: 1px solid #d82234;
}
.resultDetail {
    display: flex;
    flex-direction: row;
    border: 0;
}
.resultColumn {
    flex-grow: 1;
    text-align: center;
}
.resultUnsei .resultColumn h2,
.resultHitokoto .resultColumn h2 {
    margin-bottom: 10px;
    font-size: 28px;
}
.resultUnsei .resultColumn p {
    font-size: 40px;
}
.resultHitokoto .resultColumn p {
    font-size: 22px;
}
.resultDetail .resultColumn {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin: 10px 0;
    gap: 10px;
    border-right: 1px dashed #d82234;

    writing-mode: vertical-rl;
    -webkit-writing-mode: vertical-rl;
    -ms-writing-mode: vertical-rl;
    text-orientation: upright;
}
.resultDetail .resultSekkin {
    border: 0;
}
.resultDetail .resultColumn h2 {
    height: 85px;
    font-size: 20px;
}
.resultDetail .resultColumn p {
    height: 250px;
    font-size: 16px;
    text-align: left;
}

/* rubyとbackground-clipの相性が悪いため、力技でruby相当のレイアウトをする */
.resultUnsei .resultColumn p .ruby {
    line-height: 0px; /* 余計な隙間をなくす */
}
.resultUnsei .resultColumn p .rt {
    display: inline-block;
    font-size: 20px;
    letter-spacing: 20px;
    line-height: 20px;
    margin: 0 -10px 0 10px;
}
.resultUnsei .resultColumn p .rb {
    display: inline-block;
    font-size: 40px;
    line-height: 40px;
}

/* 虹色 */
.gaming {
    background: linear-gradient(to right,#e60000,#f39800,#fff100,#009944,#0068b7,#1d2088,#920783);
    background-size: 200% 200%;
    background-clip: text;
    -webkit-background-clip: text;
    /* text-fill-colorはエディタが警告出すのでプレフィックス付きだけ */
    -webkit-text-fill-color: rgba(0, 0, 0, 0.1);
    display: inline-block;
    animation: gaming 2s linear infinite;
}
@keyframes gaming {
    100% { background-position: 200%; }
}

/* for iPhone SE */
@media screen and (max-width: 375px) {
    /* おみくじを引く前 */
    .title {
        margin: 20px 0;
    }
    .omikuji {
        max-width: 180px;
    }
    button {
        margin: 20px 0;
    }

    /* おみくじを引いた後 */
    .resultContainer {
        width: calc(100% - 20px);
        margin: 10px 0 0 0;
    }
    .resultUnsei .resultColumn h2,
    .resultHitokoto .resultColumn h2 {
        font-size: 20px;
    }
    .resultHitokoto .resultColumn p {
        font-size: 16px;
    }
    .resultDetail .resultColumn p {
        height: 150px;
    }
} 
</style>
</head>

<body>
    <div id="omikujiWrapper" class="wrapper">
        <div class="title">
            <p>くすサポおみくじ2024</p>
        </div>
        <div>
            <img id="omikuji" class="omikuji" src="image/omikuji.png" alt="omikuji"/>
        </div>
        <button id="drawButton">
            おみくじをひく
        </button>
    </div>
    <div class="resultWrapper">
        <div class="resultContainer">
            <div class="resultRow resultUnsei">
                <div class="resultColumn">
                    <h2>くっす運</h2>
                    <p></p>
                </div>
            </div>
            <div class="resultRow resultHitokoto">
                <div class="resultColumn">
                    <h2>一言</h2>
                    <p></p>
                </div>
            </div>
            <div class="resultRow resultDetail">
                <div class="resultColumn resultEvent">
                    <h2>イベント</h2>
                    <p></p>
                </div>
                <div class="resultColumn resultSocial">
                    <h2>ソシャゲ</h2>
                    <p></p>
                </div>
                <div class="resultColumn resultSekkin">
                    <h2>接近戦</h2>
                    <p></p>
                </div>
            </div>
        </div>
        <h1>くすサポおみくじ2024</h1>
    </div>
</body>
<script>

const drawButton = document.querySelector('#drawButton');
const omikuji = document.querySelector('#omikuji');
const omikujiWrapper = document.querySelector('#omikujiWrapper');
drawButton.addEventListener('click', () =>{
    drawButton.style.display ="none";
    tatefuri();
});

function tatefuri() {
    omikuji.animate(
      [{
        transform: 'translateY(0)'
      }, {
        transform: 'translateY(-30px)'
      }, {
        transform: 'translateY(0)'
      }], {
        duration: 400,
        iterations: 3
      });
    setTimeout(function() {
      kaiten();
    }, 1200);
}

function kaiten() {
    omikuji.animate(
        [{
        transform: 'rotate(0deg)'
        }, {
        transform: 'rotate(160deg)'
        }], {
        duration: 700,
        easing: 'linear',
        fill: 'forwards'
    });
    setTimeout(function() {
        removeOmikuji();
    }, 1000);
}

function removeOmikuji() {
    omikujiWrapper.animate(
        [{
        opacity: 1
        }, {
        opacity: 0
        }], {
        duration: 500,
        fill: 'forwards'
    });
    setTimeout(function() {
        showResult();
        omikujiWrapper.remove();
    }, 500);
}

const unseiHtmlList = [
    "<span class='gaming ruby'><span class='rt'>　　　くすだ　</span><span class='rb'>デラックス大吉</span></span>",
    "中吉",
    "小吉",
    "凶",
]
const hitokotoList = [
    [
        "ぐりふぃんどーーーる！",
    ],
    [
        "プリンたべちゃおっ",
        "アイスたべちゃおっ",
    ],
    [
        "年末のはじまりだよ",
        "地球がわたしに休めと言っているんだ",
    ],
    [
        "始まりがあれば終わりがある",
        "まぁそういうこともあるよね",
        "口内炎っていつの間にかできてるよね",
    ],
]
const eventList = [
    [
        "チケ当たるしアリーナ前方",
    ],
    [
        "円盤3枚くらい積め",
        "一般ねばればチケ買える",
    ],
    [
        "トロッコを待て",
        "双眼鏡があるとよし",
    ],
    [
        "たくさん円盤積め",
        "支払い忘れに注意",
        "チケットを家に忘れがち",
    ],
]
const socialList = [
    [
        "10連ガチャでUR3枚引ける",
    ],
    [
        "恒常URは出る",
        "詫び石いっぱいもらえる",
    ],
    [
        "目玉UR出るが凸は無理",
        "本編よりサイドストーリー進める癖は直しなさい",
    ],
    [
        "天井を覚悟せよ",
        "すり抜け多し",
        "育成アイテムを貯めておくべし",
    ],
]
const sekkinList = [
    [
        "盛り上がるし、推しの顔が良すぎて泣いた",
    ],
    [
        "剥がしがゆるい",
        "向こうのペースに飲まれる",
    ],
    [
        "聞き返される",
        "前のやつが盛り上がりすぎ",
    ],
    [
        "認知切れを覚悟せよ",
        "ハキハキしゃべるべし",
        "頭が真っ白になる",
    ],
]

function showResult() {
    const unseiIndex = (function () {
        const r = Math.random()
        if (r < 0.1) {
            return 0 // デラックス大吉 = 10%
        } else if (r < 0.4) {
            return 1 // 中吉 = 30%
        } else if (r < 0.7) {
            return 2 // 小吉 = 30%
        } else {
            return 3 // 凶 = 30%
        }
    })();
    const unseiHtml = unseiHtmlList[unseiIndex]
    document.querySelector(".resultUnsei .resultColumn p").innerHTML = unseiHtml
    const hitokotoIndex = Math.floor(Math.random() * hitokotoList[unseiIndex].length)
    const hitokoto = hitokotoList[unseiIndex][hitokotoIndex]
    document.querySelector(".resultHitokoto .resultColumn p").textContent = hitokoto
    const eventIndex = Math.floor(Math.random() * eventList[unseiIndex].length)
    const event = eventList[unseiIndex][eventIndex]
    document.querySelector(".resultDetail .resultEvent p").textContent = event
    const socialIndex = Math.floor(Math.random() * socialList[unseiIndex].length)
    const social = socialList[unseiIndex][socialIndex]
    document.querySelector(".resultDetail .resultSocial p").textContent = social
    const sekkinIndex = Math.floor(Math.random() * sekkinList[unseiIndex].length)
    const sekkin = sekkinList[unseiIndex][sekkinIndex]
    document.querySelector(".resultDetail .resultSekkin p").textContent = sekkin

    const resultContainer = document.querySelector(".resultWrapper")
    resultContainer.style.display = "grid"
    resultContainer.animate(
        [{
        transform: 'translateY(0) scale(1)'
        }, {
        transform: 'translateY(-30px)'
        }, {
        transform: 'scale(1)'
        }, {
        transform: 'scale(1.1)'
        }, {
        transform: 'translateY(0) scale(1)'
        }], {
        duration: 1000,
        fill: 'forwards'
    });
} 

</script>
</html>
